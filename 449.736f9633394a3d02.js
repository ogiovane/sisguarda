"use strict";(self.webpackChunkmantis_free_version=self.webpackChunkmantis_free_version||[]).push([[449],{6449:(C,c,r)=>{r.r(c),r.d(c,{MateriaisCauteladosComponent:()=>m});var n=r(6814),t=r(9212),l=r(7398),d=r(5835);let p=(()=>{class i{constructor(e){this.firestore=e}addCautela(e){return this.firestore.collection("historico-cautelas").add(e)}buscarMateriaisCautelados(){return this.firestore.collection("historico",e=>e.where("status","!=","Dispon\xedvel")).snapshotChanges().pipe((0,l.U)(e=>e.map(a=>{const o=a.payload.doc.data();return{id:a.payload.doc.id,...o}})))}static#t=this.\u0275fac=function(a){return new(a||i)(t.LFG(d.ST))};static#e=this.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var h=r(5076);let Z=(()=>{class i{constructor(e){this.firestore=e}buscarTotaisMateriais(){return this.firestore.collection("materiais").snapshotChanges().pipe((0,l.U)(e=>e.map(a=>{const o=a.payload.doc.data();return{id:a.payload.doc.id,...o}})),(0,l.U)(e=>e.reduce((o,s)=>(o[s.tipo]||(o[s.tipo]={disponiveis:0,cautelados:0,total:0}),"Dispon\xedvel"===s.status?o[s.tipo].disponiveis+=1:"Cautelado"===s.status&&(o[s.tipo].cautelados+=1),o[s.tipo].total+=1,o),{})))}getMateriaisDisponiveisPorTipo(e){return this.firestore.collection("materiais",a=>a.where("tipo","==",e).where("status","==","Dispon\xedvel")).valueChanges({idField:"id"})}static#t=this.\u0275fac=function(a){return new(a||i)(t.LFG(d.ST))};static#e=this.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();function v(i,u){if(1&i){const e=t.EpF();t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td")(8,"button",5),t.NdJ("click",function(){const s=t.CHM(e).$implicit,T=t.oxw();return t.KtG(T.devolverMaterial(s))}),t._uU(9,"Devolver"),t.qZA()()()}if(2&i){const e=u.$implicit;t.xp6(2),t.Oqu(e.tipo),t.xp6(2),t.Oqu(e.descricaoMaterial),t.xp6(2),t.Oqu(e.status)}}function f(i,u){1&i&&(t.TgZ(0,"div",6),t._uU(1," Nenhum material para exibir. "),t.qZA())}function g(i,u){if(1&i&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.qZA()()),2&i){const e=u.$implicit;t.xp6(2),t.Oqu(e.key),t.xp6(2),t.Oqu(e.value.disponiveis),t.xp6(2),t.Oqu(e.value.cautelados),t.xp6(2),t.Oqu(e.value.total)}}let m=(()=>{class i{constructor(e,a,o){this.historicoService=e,this.router=a,this.materiaisService=o,this.materiais=[],this.totaisMateriais={}}ngOnInit(){this.historicoService.buscarMateriaisCautelados().subscribe(e=>{this.materiais=e}),this.materiaisService.buscarTotaisMateriais().subscribe(e=>{this.totaisMateriais=e})}devolverMaterial(e){this.router.navigate(["/devolver-material"],{state:{material:e}})}static#t=this.\u0275fac=function(a){return new(a||i)(t.Y36(p),t.Y36(h.F0),t.Y36(Z))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-materiais-cautelados"]],standalone:!0,features:[t.jDz],decls:34,vars:5,consts:[[1,"container","mt-4"],[1,"table","table-bordered"],[4,"ngFor","ngForOf"],["class","alert alert-info","role","alert",4,"ngIf"],[1,"table","table-bordered","text-center"],[1,"btn","btn-danger",3,"click"],["role","alert",1,"alert","alert-info"]],template:function(a,o){1&a&&(t.TgZ(0,"div",0)(1,"h3"),t._uU(2,"Materiais Cautelados"),t.qZA(),t.TgZ(3,"table",1)(4,"thead")(5,"tr")(6,"th"),t._uU(7,"Tipo"),t.qZA(),t.TgZ(8,"th"),t._uU(9,"Descri\xe7\xe3o"),t.qZA(),t.TgZ(10,"th"),t._uU(11,"Status"),t.qZA(),t.TgZ(12,"th"),t._uU(13,"A\xe7\xe3o"),t.qZA()()(),t.TgZ(14,"tbody"),t.YNc(15,v,10,3,"tr",2),t.qZA()(),t.YNc(16,f,2,0,"div",3),t.qZA(),t.TgZ(17,"div",0)(18,"h3"),t._uU(19,"Contabiliza\xe7\xe3o"),t.qZA(),t.TgZ(20,"table",4)(21,"thead")(22,"tr")(23,"th"),t._uU(24,"Tipo"),t.qZA(),t.TgZ(25,"th"),t._uU(26,"Dispon\xedveis"),t.qZA(),t.TgZ(27,"th"),t._uU(28,"Cautelados"),t.qZA(),t.TgZ(29,"th"),t._uU(30,"Total"),t.qZA()()(),t.TgZ(31,"tbody"),t.YNc(32,g,9,4,"tr",2),t.ALo(33,"keyvalue"),t.qZA()()()),2&a&&(t.xp6(15),t.Q6J("ngForOf",o.materiais),t.xp6(),t.Q6J("ngIf",0===o.materiais.length),t.xp6(16),t.Q6J("ngForOf",t.lcZ(33,3,o.totaisMateriais)))},dependencies:[n.ez,n.sg,n.O5,n.Nd],encapsulation:2})}return i})()}}]);